import{d as m,r as h,c as _,b as C,w as S,a as t,v as b,g,o as u,f as p,_ as w,t as n,u as $,h as k,i as D,j as W,k as E,l as y,m as I}from"./index-S6pMhctB.js";const U=m({__name:"CitySearch",emits:["search"],setup(v,{emit:o}){const i=o,a=h(""),c=()=>{a.value.trim()&&(i("search",a.value.trim()),a.value="")},l=async()=>{if(a.value.trim())try{const s=await p.get(`/weather/city/${encodeURIComponent(a.value.trim())}`);i("search",{city:s.data.name,temp:s.data.main.temp,description:s.data.weather[0].description,time:new Date().toLocaleString()}),a.value=""}catch(s){alert(s.response?.data?.message||"Failed to fetch weather")}};return(s,d)=>(u(),_("form",{onSubmit:C(l,["prevent"]),class:"search-form"},[S(t("input",{"onUpdate:modelValue":d[0]||(d[0]=r=>a.value=r),type:"text",placeholder:"Enter city...",class:"search-input",onKeyup:g(c,["enter"])},null,544),[[b,a.value]]),t("button",{type:"submit",onClick:c,class:"search-button"}," Search ")],32))}}),V=w(U,[["__scopeId","data-v-ebfbb230"]]),x={class:"weather-card"},B={class:"weather-title"},H={class:"weather-info"},M={class:"weather-info"},N={class:"weather-updated"},T=m({__name:"WeatherCard",props:{weather:{}},setup(v){return(o,i)=>(u(),_("div",x,[t("h2",B,n(o.weather.city),1),t("p",H,"Temperature: "+n(o.weather.temp)+"Â°C",1),t("p",M,"Condition: "+n(o.weather.description),1),t("p",N,"Updated: "+n(o.weather.time),1)]))}}),K=w(T,[["__scopeId","data-v-04d77454"]]),L={class:"dashboard"},R={class:"stats"},j={class:"card"},A={class:"card"},F=m({__name:"Dashboard",setup(v){const i=$().userEmail,a=h([]),c=h([]),l=h(null),s=async()=>{const r=await p.get("/weather/history");a.value=r.data;const e=new Set(r.data.map(f=>f.city.name));c.value=[...e]},d=async r=>{try{const e=await p.get(`/weather/city/${encodeURIComponent(r)}`);l.value={city:r,temp:e.data.main.temp,description:e.data.weather[0].description,time:new Date().toLocaleString()},await s()}catch(e){console.error("City fetch failed:",e.response?.data||e.message)}};return k(s),(r,e)=>(u(),_("div",L,[e[4]||(e[4]=t("h2",null,"User Dashboard",-1)),t("p",null,[e[0]||(e[0]=y("Welcome back, ")),t("strong",null,n(I(i)),1),e[1]||(e[1]=y("!"))]),D(V,{onSearch:d}),l.value?(u(),W(K,{key:0,weather:l.value},null,8,["weather"])):E("",!0),t("div",R,[t("div",j,[e[2]||(e[2]=t("h3",null,"Saved Cities",-1)),t("p",null,n(c.value.length),1)]),t("div",A,[e[3]||(e[3]=t("h3",null,"Weather History",-1)),t("p",null,n(a.value.length)+" Entries",1)])])]))}}),z=w(F,[["__scopeId","data-v-91a3d205"]]);export{z as default};
